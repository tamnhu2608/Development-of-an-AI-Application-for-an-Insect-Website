{% extends "template_v2.html" %}

{% block title %}
Cây trồng: {{ crop.name }}
{% endblock %}

{% block content %}
<div class="container py-4">

    <!-- Tên cây trồng căn giữa -->
    <div class="text-center mb-4">
        <h2 class="fw-bold">
            {{ crop.name }}
            {% if crop.scientific_name %}
                <small class="text-muted">({{ crop.scientific_name }})</small>
            {% endif %}
        </h2>
        
    </div>

    <!-- Khối thông tin chi tiết cây trồng -->
    <div class="card shadow-sm mb-4">
        <div class="card-body">
            <h5 class="fw-bold mb-3 text-success">Thông tin chi tiết cây trồng</h5>
            
            <p><strong>Tên cây:</strong> {{ crop.name }}</p>
            <p><strong>Tên khoa học:</strong> {{ crop.scientific_name|default:"Chưa cập nhật" }}</p>
            <p><strong>Mô tả:</strong> {{ crop.description|default:"Chưa cập nhật thông tin." }}</p>
            <p><strong>Giá trị kinh tế:</strong> {{ crop.economic_value|default:"Chưa cập nhật thông tin." }}</p>
            <p><strong>Đặc điểm hình thái:</strong> {{ crop.morphology|default:"Chưa cập nhật thông tin." }}</p>
            <p><strong>Vùng trồng phổ biến:</strong> {{ crop.cultivation_area|default:"Chưa cập nhật thông tin." }}</p>
        </div>
    </div>

    <!-- Danh sách côn trùng gây hại -->
    <h5 class="mb-3">Danh sách côn trùng gây hại</h5>
    {% if damages %}
        <div class="table-responsive">
            <table class="table table-bordered table-hover align-middle">
                <thead class="table-light">
                    <tr>
                        <th>Loài côn trùng</th>
                        <th>Mức độ hại</th>
                        <th>Mô tả</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    {% for d in damages %}
                    <tr>
                        <td>
                            <strong>{{ d.species.name }}</strong><br>
                            <small class="text-muted">{{ d.species.scientific_name }}</small>
                        </td>
                        <td>
                            {% if d.damage_level == 'low' %}
                                <span class="badge bg-success">Nhẹ</span>
                            {% elif d.damage_level == 'medium' %}
                                <span class="badge bg-warning text-dark">Trung bình</span>
                            {% else %}
                                <span class="badge bg-danger">Nặng</span>
                            {% endif %}
                        </td>
                        <td class="text-dark">
                            {{ d.description|default:"—" }}
                        </td>
                        <td class="text-center">
                            <a href="{% url 'detail' d.species.slug %}" 
                                class="btn btn-sm btn-outline-primary" >
                                Xem loài
                            </a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% else %}
        <div class="alert alert-info">
            Chưa có dữ liệu côn trùng gây hại cho cây này.
        </div>
    {% endif %}

</div>
{% endblock %}
